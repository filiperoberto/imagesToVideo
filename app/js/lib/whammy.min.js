window.Whammy=function(){function t(t,r){for(var e=a(t),i=3e4,n=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:f(e.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:e.width,id:176},{data:e.height,id:186}]}]}]},{id:475249515,data:[]}]}],o=n[1],h=o.data[2],s=0,c=0;s<t.length;){var l={id:187,data:[{data:Math.round(c),id:179},{id:183,data:[{data:1,id:247},{data:0,size:8,id:241}]}]};h.data.push(l);var m=[],g=0;do m.push(t[s]),g+=t[s].duration,s++;while(s<t.length&&i>g);var p=0,v={id:524531317,data:[{data:Math.round(c),id:231}].concat(m.map(function(t){var a=u({discardable:0,frame:t.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(p)});return p+=t.duration,{data:a,id:163}}))};o.data.push(v),c+=g}for(var w=0,y=0;y<o.data.length;y++){y>=3&&(h.data[y-3].data[1].data[1].data=w);var b=d([o.data[y]],r);w+=b.size||b.byteLength||b.length,2!=y&&(o.data[y]=b)}return d(n,r)}function a(t){for(var a=t[0].width,r=t[0].height,e=t[0].duration,i=1;i<t.length;i++){if(t[i].width!=a)throw"Frame "+(i+1)+" has a different width";if(t[i].height!=r)throw"Frame "+(i+1)+" has a different height";if(t[i].duration<0||t[i].duration>32767)throw"Frame "+(i+1)+" has a weird duration (must be between 0 and 32767)";e+=t[i].duration}return{duration:e,width:a,height:r}}function r(t){for(var a=[];t>0;)a.push(255&t),t>>=8;return new Uint8Array(a.reverse())}function e(t,a){for(var r=new Uint8Array(a),e=a-1;e>=0;e--)r[e]=255&t,t>>=8;return r}function i(t){for(var a=new Uint8Array(t.length),r=0;r<t.length;r++)a[r]=t.charCodeAt(r);return a}function n(t){var a=[],r=t.length%8?new Array(9-t.length%8).join("0"):"";t=r+t;for(var e=0;e<t.length;e+=8)a.push(parseInt(t.substr(e,8),2));return new Uint8Array(a)}function d(t,a){for(var u=[],h=0;h<t.length;h++)if("id"in t[h]){var s=t[h].data;if("object"==typeof s&&(s=d(s,a)),"number"==typeof s&&(s="size"in t[h]?e(s,t[h].size):n(s.toString(2))),"string"==typeof s&&(s=i(s)),s.length);var f=s.size||s.byteLength||s.length,c=Math.ceil(Math.ceil(Math.log(f)/Math.log(2))/8),l=f.toString(2),m=new Array(7*c+7+1-l.length).join("0")+l,g=new Array(c).join("0")+"1"+m;u.push(r(t[h].id)),u.push(n(g)),u.push(s)}else u.push(t[h]);if(a){var p=o(u);return new Uint8Array(p)}return new Blob(u,{type:"video/webm"})}function o(t,a){null==a&&(a=[]);for(var r=0;r<t.length;r++)"object"==typeof t[r]?o(t[r],a):a.push(t[r]);return a}function u(t){var a=0;if(t.keyframe&&(a|=128),t.invisible&&(a|=8),t.lacing&&(a|=t.lacing<<1),t.discardable&&(a|=1),t.trackNum>127)throw"TrackNumber > 127 not supported";var r=[128|t.trackNum,t.timecode>>8,255&t.timecode,a].map(function(t){return String.fromCharCode(t)}).join("")+t.frame;return r}function h(t){for(var a=t.RIFF[0].WEBP[0],r=a.indexOf("*"),e=0,i=[];4>e;e++)i[e]=a.charCodeAt(r+3+e);var n,d,o,u,h;return h=i[1]<<8|i[0],n=16383&h,d=h>>14,h=i[3]<<8|i[2],o=16383&h,u=h>>14,{width:n,height:o,data:a,riff:t}}function s(t){for(var a=0,r={};a<t.length;){var e=t.substr(a,4);if(r[e]=r[e]||[],"RIFF"==e||"LIST"==e){var i=parseInt(t.substr(a+4,4).split("").map(function(t){var a=t.charCodeAt(0).toString(2);return new Array(8-a.length+1).join("0")+a}).join(""),2),n=t.substr(a+4+4,i);a+=8+i,r[e].push(s(n))}else"WEBP"==e?(r[e].push(t.substr(a+8)),a=t.length):(r[e].push(t.substr(a+4)),a=t.length)}return r}function f(t){return[].slice.call(new Uint8Array(new Float64Array([t]).buffer),0).map(function(t){return String.fromCharCode(t)}).reverse().join("")}function c(t,a){this.frames=[],this.duration=1e3/t,this.quality=a||.8}return c.prototype.add=function(t,a){if("undefined"!=typeof a&&this.duration)throw"you can't pass a duration if the fps is set";if("undefined"==typeof a&&!this.duration)throw"if you don't have the fps set, you ned to have durations here.";if(t.canvas&&(t=t.canvas),t.toDataURL)t=t.toDataURL("image/webp",this.quality);else if("string"!=typeof t)throw"frame must be a a HTMLCanvasElement, a CanvasRenderingContext2D or a DataURI formatted string";if(!/^data:image\/webp;base64,/gi.test(t))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:t,duration:a||this.duration})},c.prototype.compile=function(a){return new t(this.frames.map(function(t){var a=h(s(atob(t.image.slice(23))));return a.duration=t.duration,a}),a)},{Video:c,fromImageArray:function(a,r,e){return t(a.map(function(t){var a=h(s(atob(t.slice(23))));return a.duration=1e3/r,a}),e)},toWebM:t}}();